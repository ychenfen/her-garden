<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¥¹çš„èŠ±å›­ - ç›†åº•è‚Œè®­ç»ƒå·¥åŠ</title>
    <style>
        :root {
            --primary: #ff8fab;
            --primary-dark: #ff6b9d;
            --secondary: #ffc2d1;
            --bg-color: #1a1a2e;
            --bg-light: #252540;
            --text-color: #fff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(180deg, var(--bg-color) 0%, #16213e 100%);
            color: var(--text-color);
            min-height: 100vh;
            display: flex; flex-direction: column;
            overflow-x: hidden;
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        header {
            padding: 20px; text-align: center; position: relative;
            background: rgba(0,0,0,0.2);
        }
        .header-back {
            position: absolute; left: 20px; top: 50%; transform: translateY(-50%);
            color: rgba(255,255,255,0.6); text-decoration: none; font-size: 1.3rem;
            transition: color 0.2s;
        }
        .header-back:hover { color: var(--primary); }
        h1 {
            margin: 0; font-weight: 400; letter-spacing: 3px;
            font-size: 1.2rem; color: var(--primary);
        }
        .header-sub {
            font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 5px;
        }

        /* æ•°æ®é¢æ¿ */
        .stats-bar {
            display: flex; justify-content: center; gap: 30px;
            padding: 15px 20px;
            background: rgba(255,255,255,0.03);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .stat-item { text-align: center; }
        .stat-value {
            font-size: 1.8rem; font-weight: bold; color: var(--primary);
            font-family: 'Helvetica Neue', sans-serif;
        }
        .stat-label {
            font-size: 0.7rem; color: rgba(255,255,255,0.5);
            text-transform: uppercase; letter-spacing: 1px; margin-top: 2px;
        }

        /* æ ¸å¿ƒè®­ç»ƒåŒº */
        .training-area {
            flex: 1; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            padding: 30px 20px;
            position: relative;
        }

        /* å‘¼å¸åœ†ç¯å®¹å™¨ */
        .circle-container {
            position: relative;
            width: 280px; height: 280px;
            display: flex; justify-content: center; align-items: center;
        }

        /* å¤–åœˆè½¨é“ */
        .circle-track {
            position: absolute; width: 100%; height: 100%;
            border: 2px solid rgba(255, 143, 171, 0.15);
            border-radius: 50%;
        }

        /* è¿›åº¦ç¯ */
        .circle-progress {
            position: absolute; width: 100%; height: 100%;
        }
        .circle-progress svg {
            width: 100%; height: 100%;
            transform: rotate(-90deg);
        }
        .progress-ring {
            fill: none;
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-dasharray: 879; /* 2 * PI * 140 */
            stroke-dashoffset: 879;
            transition: stroke-dashoffset 0.1s linear;
            filter: drop-shadow(0 0 8px var(--primary));
        }

        /* åŠ¨æ€å‘¼å¸åœ† */
        .circle-main {
            width: 220px; height: 220px;
            background: radial-gradient(circle at 40% 40%,
                rgba(255, 143, 171, 0.6) 0%,
                rgba(255, 107, 157, 0.4) 40%,
                rgba(255, 0, 85, 0.2) 70%,
                transparent 100%
            );
            border-radius: 50%;
            transform: scale(0.4);
            transition: transform 0.1s linear;
            box-shadow:
                0 0 60px rgba(255, 143, 171, 0.3),
                inset 0 0 40px rgba(255, 255, 255, 0.1);
        }

        /* ä¸­å¿ƒçŠ¶æ€æ–‡å­— */
        .status-display {
            position: absolute; text-align: center;
            pointer-events: none; z-index: 10;
        }
        .action-text {
            font-size: 1.6rem; font-weight: 600;
            text-shadow: 0 2px 15px rgba(0,0,0,0.5);
            margin-bottom: 8px;
        }
        .timer-text {
            font-size: 2.5rem; font-weight: 300;
            font-family: 'Helvetica Neue', monospace;
            color: rgba(255,255,255,0.9);
        }
        .round-text {
            font-size: 0.85rem; color: rgba(255,255,255,0.5);
            margin-top: 8px;
        }

        /* æ§åˆ¶é¢æ¿ */
        .controls {
            padding: 30px 20px 40px;
            text-align: center;
            background: linear-gradient(to top, rgba(0,0,0,0.5), transparent);
        }

        .btn-main {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: #fff; border: none;
            padding: 16px 60px; font-size: 1.1rem; font-weight: 500;
            border-radius: 35px; cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 143, 171, 0.4);
            transition: all 0.3s ease;
            letter-spacing: 2px;
        }
        .btn-main:hover { transform: translateY(-2px); box-shadow: 0 12px 30px rgba(255, 143, 171, 0.5); }
        .btn-main:active { transform: scale(0.98); }
        .btn-main.training {
            background: linear-gradient(135deg, #ff4d6d, #c9184a);
            box-shadow: 0 8px 25px rgba(255, 77, 109, 0.4);
        }

        /* è®¾ç½®æŒ‰é’®ç»„ */
        .settings-row {
            display: flex; justify-content: center; gap: 15px;
            margin-top: 20px; flex-wrap: wrap;
        }
        .setting-btn {
            padding: 8px 16px; font-size: 0.8rem;
            background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15);
            color: rgba(255,255,255,0.7); border-radius: 20px;
            cursor: pointer; transition: all 0.2s;
        }
        .setting-btn:hover { background: rgba(255,255,255,0.15); color: #fff; }
        .setting-btn.active { background: var(--primary); color: #fff; border-color: transparent; }

        /* åº•éƒ¨é“¾æ¥ */
        .bottom-links {
            margin-top: 25px; font-size: 0.85rem;
        }
        .bottom-links a {
            color: rgba(255,255,255,0.4); text-decoration: none;
            margin: 0 12px; transition: color 0.2s;
        }
        .bottom-links a:hover { color: var(--primary); }

        /* æ•™ç¨‹å¼¹çª— */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
            padding: 20px;
        }
        .modal-overlay.visible { opacity: 1; pointer-events: auto; }

        .modal-content {
            background: var(--bg-light); padding: 30px;
            border-radius: 24px; max-width: 400px; width: 100%;
            border: 1px solid rgba(255, 143, 171, 0.3);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .modal-content h2 {
            color: var(--primary); margin: 0 0 20px;
            font-size: 1.3rem; font-weight: 500;
        }
        .modal-content p {
            font-size: 0.9rem; line-height: 1.7; color: rgba(255,255,255,0.8);
            margin-bottom: 15px;
        }
        .modal-content strong { color: var(--primary); }
        .modal-content .tip {
            background: rgba(255, 143, 171, 0.1);
            border-left: 3px solid var(--primary);
            padding: 12px 15px; border-radius: 0 8px 8px 0;
            font-size: 0.85rem; margin: 20px 0;
        }
        .modal-btn {
            display: block; width: 100%; padding: 14px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none; border-radius: 12px;
            color: #fff; font-size: 1rem; cursor: pointer;
            margin-top: 10px; transition: transform 0.2s;
        }
        .modal-btn:hover { transform: scale(1.02); }

        /* å®Œæˆå¼¹çª— */
        .complete-modal .modal-content {
            text-align: center;
        }
        .complete-icon {
            font-size: 4rem; margin-bottom: 15px;
        }
        .complete-stats {
            display: flex; justify-content: center; gap: 30px;
            margin: 20px 0;
        }

        /* å“åº”å¼ */
        @media screen and (max-width: 380px) {
            .circle-container { width: 240px; height: 240px; }
            .circle-main { width: 180px; height: 180px; }
            .action-text { font-size: 1.3rem; }
            .timer-text { font-size: 2rem; }
            .btn-main { padding: 14px 45px; font-size: 1rem; }
        }

        @media screen and (max-height: 600px) {
            .stats-bar { padding: 10px 20px; }
            .training-area { padding: 15px 20px; }
            .circle-container { width: 200px; height: 200px; }
            .circle-main { width: 160px; height: 160px; }
            .controls { padding: 20px; }
        }
    </style>
</head>
<body>

    <header>
        <a href="index.html" class="header-back">â†</a>
        <h1>ç›†åº•è‚Œè®­ç»ƒå·¥åŠ</h1>
        <p class="header-sub">æ¯å¤©5åˆ†é’Ÿï¼Œå®ˆæŠ¤ä½ çš„å¥åº·</p>
    </header>

    <div class="stats-bar">
        <div class="stat-item">
            <div class="stat-value" id="streak-count">0</div>
            <div class="stat-label">è¿ç»­æ‰“å¡</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="total-sessions">0</div>
            <div class="stat-label">ç´¯è®¡è®­ç»ƒ</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="today-rounds">0</div>
            <div class="stat-label">ä»Šæ—¥å®Œæˆ</div>
        </div>
    </div>

    <div class="training-area">
        <div class="circle-container">
            <div class="circle-track"></div>
            <div class="circle-progress">
                <svg viewBox="0 0 300 300">
                    <circle class="progress-ring" cx="150" cy="150" r="140"></circle>
                </svg>
            </div>
            <div class="circle-main" id="circle"></div>
            <div class="status-display">
                <div class="action-text" id="action-text">å‡†å¤‡å¼€å§‹</div>
                <div class="timer-text" id="timer-text">0.0</div>
                <div class="round-text" id="round-text">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button class="btn-main" id="btn-toggle">å¼€å§‹è®­ç»ƒ</button>

        <div class="settings-row">
            <button class="setting-btn active" data-rounds="10">10ç»„</button>
            <button class="setting-btn" data-rounds="15">15ç»„</button>
            <button class="setting-btn" data-rounds="20">20ç»„</button>
        </div>

        <div class="bottom-links">
            <a href="#" id="btn-tutorial">â“ æ€ä¹ˆå‘åŠ›</a>
            <a href="checker.html">ğŸ” å¥åº·è§£ç </a>
            <a href="cycle-simulator.html">ğŸ”„ å‘¨æœŸæ¨¡æ‹Ÿ</a>
        </div>
    </div>

    <!-- æ•™ç¨‹å¼¹çª— -->
    <div class="modal-overlay" id="tutorial-modal">
        <div class="modal-content">
            <h2>å¦‚ä½•æ‰¾åˆ°ç›†åº•è‚Œï¼Ÿ</h2>
            <p><strong>æ–¹æ³•ä¸€ï¼š</strong>æƒ³è±¡ä½ æ­£åœ¨æ’å°¿ï¼Œç„¶åè¯•å›¾<strong>çªç„¶ä¸­æ–­å°¿æµ</strong>ã€‚é‚£ä¸€åˆ»æ”¶ç´§çš„è‚Œè‚‰å°±æ˜¯ç›†åº•è‚Œã€‚</p>
            <p><strong>æ–¹æ³•äºŒï¼š</strong>æƒ³è±¡ä½ åœ¨å…¬å…±åœºåˆï¼Œè¯•å›¾<strong>æ†‹ä½ä¸€ä¸ªå±</strong>ã€‚ç”¨åˆ°çš„å°±æ˜¯è¿™å—è‚Œè‚‰ã€‚</p>
            <div class="tip">
                <strong>âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</strong><br>
                â€¢ è®­ç»ƒæ—¶ä¿æŒæ­£å¸¸å‘¼å¸ï¼Œä¸è¦æ†‹æ°”<br>
                â€¢ ä¸è¦åŒæ—¶æ”¶ç´§å¤§è…¿ã€è‡€éƒ¨æˆ–è…¹éƒ¨<br>
                â€¢ åªä¸“æ³¨äºç›†åº•è‚Œçš„æ”¶ç¼©å’Œæ”¾æ¾
            </div>
            <button class="modal-btn" id="btn-close-tutorial">æˆ‘å­¦ä¼šäº†ï¼Œå¼€å§‹è®­ç»ƒ</button>
        </div>
    </div>

    <!-- å®Œæˆå¼¹çª— -->
    <div class="modal-overlay complete-modal" id="complete-modal">
        <div class="modal-content">
            <div class="complete-icon">ğŸ‰</div>
            <h2>è®­ç»ƒå®Œæˆï¼</h2>
            <div class="complete-stats">
                <div class="stat-item">
                    <div class="stat-value" id="complete-rounds">10</div>
                    <div class="stat-label">å®Œæˆç»„æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="complete-streak">1</div>
                    <div class="stat-label">è¿ç»­å¤©æ•°</div>
                </div>
            </div>
            <p style="color: rgba(255,255,255,0.6); font-size: 0.9rem;">
                åšæŒæ¯å¤©ç»ƒä¹ ï¼Œè®©ç›†åº•è‚Œè¶Šæ¥è¶Šå¼ºå£®ï¼
            </p>
            <button class="modal-btn" id="btn-close-complete">å¤ªæ£’äº†ï¼</button>
        </div>
    </div>

    <script>
        // ==================== é…ç½® ====================
        const CONFIG = {
            contractTime: 3000,  // æ”¶ç¼© 3ç§’
            holdTime: 3000,      // ä¿æŒ 3ç§’
            relaxTime: 3000,     // æ”¾æ¾ 3ç§’
            rounds: 10           // é»˜è®¤10ç»„
        };

        // ==================== çŠ¶æ€ ====================
        let isTraining = false;
        let currentRound = 0;
        let phase = 'idle'; // idle, contract, hold, relax
        let phaseStartTime = 0;
        let animationId = null;

        // ==================== DOM ====================
        const circle = document.getElementById('circle');
        const actionText = document.getElementById('action-text');
        const timerText = document.getElementById('timer-text');
        const roundText = document.getElementById('round-text');
        const btnToggle = document.getElementById('btn-toggle');
        const progressRing = document.querySelector('.progress-ring');
        const circumference = 2 * Math.PI * 140;

        // ==================== éŸ³é¢‘ ====================
        let audioCtx = null;

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playTone(freq, duration, volume = 0.15) {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.frequency.value = freq;
            osc.type = 'sine';
            gain.gain.setValueAtTime(volume, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        function playContractSound() { playTone(523, 0.15); } // C5
        function playHoldSound() { playTone(659, 0.1); }      // E5
        function playRelaxSound() { playTone(392, 0.2); }     // G4
        function playCompleteSound() {
            playTone(523, 0.15);
            setTimeout(() => playTone(659, 0.15), 150);
            setTimeout(() => playTone(784, 0.3), 300);
        }

        function vibrate(ms) {
            if (navigator.vibrate) navigator.vibrate(ms);
        }

        // ==================== è®­ç»ƒé€»è¾‘ ====================
        function startTraining() {
            if (isTraining) {
                stopTraining();
                return;
            }

            initAudio();
            isTraining = true;
            currentRound = 1;
            btnToggle.textContent = 'åœæ­¢è®­ç»ƒ';
            btnToggle.classList.add('training');

            startPhase('contract');
        }

        function stopTraining() {
            isTraining = false;
            cancelAnimationFrame(animationId);
            phase = 'idle';

            // é‡ç½® UI
            circle.style.transition = 'transform 0.5s ease-out';
            circle.style.transform = 'scale(0.4)';
            actionText.textContent = 'å‡†å¤‡å¼€å§‹';
            timerText.textContent = '0.0';
            roundText.textContent = 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹';
            btnToggle.textContent = 'å¼€å§‹è®­ç»ƒ';
            btnToggle.classList.remove('training');
            setProgress(0);
        }

        function startPhase(newPhase) {
            phase = newPhase;
            phaseStartTime = performance.now();

            if (phase === 'contract') {
                playContractSound();
                vibrate(60);
                circle.style.transition = `transform ${CONFIG.contractTime}ms ease-out`;
                circle.style.transform = 'scale(1.0)';
                actionText.textContent = 'æ”¶ ç¼©';
                actionText.style.color = '#ff8fab';
            } else if (phase === 'hold') {
                playHoldSound();
                vibrate(30);
                actionText.textContent = 'ä¿ æŒ';
                actionText.style.color = '#ffd700';
            } else if (phase === 'relax') {
                playRelaxSound();
                circle.style.transition = `transform ${CONFIG.relaxTime}ms ease-in`;
                circle.style.transform = 'scale(0.4)';
                actionText.textContent = 'æ”¾ æ¾';
                actionText.style.color = '#90EE90';
            }

            loop();
        }

        function loop() {
            if (!isTraining) return;

            const now = performance.now();
            const elapsed = now - phaseStartTime;

            let phaseDuration, remaining;

            if (phase === 'contract') {
                phaseDuration = CONFIG.contractTime;
                remaining = Math.max(0, (phaseDuration - elapsed) / 1000);
                timerText.textContent = remaining.toFixed(1);
                roundText.textContent = `ç¬¬ ${currentRound} / ${CONFIG.rounds} ç»„`;

                // è¿›åº¦ç¯
                const totalCycleTime = CONFIG.contractTime + CONFIG.holdTime + CONFIG.relaxTime;
                const cycleElapsed = elapsed;
                const overallProgress = ((currentRound - 1) * totalCycleTime + cycleElapsed) / (CONFIG.rounds * totalCycleTime);
                setProgress(overallProgress);

                if (elapsed >= phaseDuration) {
                    startPhase('hold');
                    return;
                }
            } else if (phase === 'hold') {
                phaseDuration = CONFIG.holdTime;
                remaining = Math.max(0, (phaseDuration - elapsed) / 1000);
                timerText.textContent = remaining.toFixed(1);

                const totalCycleTime = CONFIG.contractTime + CONFIG.holdTime + CONFIG.relaxTime;
                const cycleElapsed = CONFIG.contractTime + elapsed;
                const overallProgress = ((currentRound - 1) * totalCycleTime + cycleElapsed) / (CONFIG.rounds * totalCycleTime);
                setProgress(overallProgress);

                if (elapsed >= phaseDuration) {
                    startPhase('relax');
                    return;
                }
            } else if (phase === 'relax') {
                phaseDuration = CONFIG.relaxTime;
                remaining = Math.max(0, (phaseDuration - elapsed) / 1000);
                timerText.textContent = remaining.toFixed(1);

                const totalCycleTime = CONFIG.contractTime + CONFIG.holdTime + CONFIG.relaxTime;
                const cycleElapsed = CONFIG.contractTime + CONFIG.holdTime + elapsed;
                const overallProgress = ((currentRound - 1) * totalCycleTime + cycleElapsed) / (CONFIG.rounds * totalCycleTime);
                setProgress(overallProgress);

                if (elapsed >= phaseDuration) {
                    currentRound++;
                    if (currentRound > CONFIG.rounds) {
                        finishTraining();
                        return;
                    }
                    startPhase('contract');
                    return;
                }
            }

            animationId = requestAnimationFrame(loop);
        }

        function setProgress(percent) {
            const offset = circumference * (1 - percent);
            progressRing.style.strokeDashoffset = offset;
        }

        function finishTraining() {
            isTraining = false;
            phase = 'idle';
            playCompleteSound();
            vibrate([100, 50, 100]);

            // æ›´æ–°ç»Ÿè®¡
            updateStats();

            // æ˜¾ç¤ºå®Œæˆå¼¹çª—
            document.getElementById('complete-rounds').textContent = CONFIG.rounds;
            document.getElementById('complete-streak').textContent = localStorage.getItem('kegel_streak') || 1;
            document.getElementById('complete-modal').classList.add('visible');

            // é‡ç½® UI
            setTimeout(() => {
                circle.style.transition = 'transform 0.5s ease-out';
                circle.style.transform = 'scale(0.4)';
                actionText.textContent = 'å®Œæˆï¼';
                actionText.style.color = '#90EE90';
                timerText.textContent = 'ğŸ‰';
                roundText.textContent = 'å¤ªæ£’äº†ï¼';
                btnToggle.textContent = 'å†æ¥ä¸€ç»„';
                btnToggle.classList.remove('training');
            }, 100);
        }

        // ==================== ç»Ÿè®¡ç³»ç»Ÿ ====================
        function initStats() {
            const streak = parseInt(localStorage.getItem('kegel_streak') || '0');
            const total = parseInt(localStorage.getItem('kegel_total') || '0');
            const todayRounds = getTodayRounds();

            document.getElementById('streak-count').textContent = streak;
            document.getElementById('total-sessions').textContent = total;
            document.getElementById('today-rounds').textContent = todayRounds;
        }

        function getTodayRounds() {
            const today = new Date().toDateString();
            const savedDate = localStorage.getItem('kegel_today_date');
            if (savedDate !== today) {
                localStorage.setItem('kegel_today_date', today);
                localStorage.setItem('kegel_today_rounds', '0');
                return 0;
            }
            return parseInt(localStorage.getItem('kegel_today_rounds') || '0');
        }

        function updateStats() {
            const today = new Date().toDateString();
            const lastDate = localStorage.getItem('kegel_last_date');

            // æ›´æ–°è¿ç»­æ‰“å¡
            if (lastDate !== today) {
                let streak = parseInt(localStorage.getItem('kegel_streak') || '0');

                // æ£€æŸ¥æ˜¯å¦æ˜¯è¿ç»­çš„ï¼ˆæ˜¨å¤©æœ‰æ‰“å¡ï¼‰
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                if (lastDate === yesterday.toDateString() || !lastDate) {
                    streak++;
                } else {
                    streak = 1; // æ–­ç­¾é‡ç½®
                }

                localStorage.setItem('kegel_streak', streak);
                localStorage.setItem('kegel_last_date', today);
                document.getElementById('streak-count').textContent = streak;
            }

            // æ›´æ–°ç´¯è®¡è®­ç»ƒ
            let total = parseInt(localStorage.getItem('kegel_total') || '0');
            total++;
            localStorage.setItem('kegel_total', total);
            document.getElementById('total-sessions').textContent = total;

            // æ›´æ–°ä»Šæ—¥å®Œæˆ
            let todayRounds = parseInt(localStorage.getItem('kegel_today_rounds') || '0');
            todayRounds++;
            localStorage.setItem('kegel_today_rounds', todayRounds);
            localStorage.setItem('kegel_today_date', today);
            document.getElementById('today-rounds').textContent = todayRounds;
        }

        // ==================== äº‹ä»¶ç›‘å¬ ====================
        btnToggle.addEventListener('click', startTraining);

        // ç»„æ•°é€‰æ‹©
        document.querySelectorAll('.setting-btn[data-rounds]').forEach(btn => {
            btn.addEventListener('click', () => {
                if (isTraining) return;
                document.querySelectorAll('.setting-btn[data-rounds]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                CONFIG.rounds = parseInt(btn.dataset.rounds);
            });
        });

        // æ•™ç¨‹å¼¹çª—
        const tutorialModal = document.getElementById('tutorial-modal');
        document.getElementById('btn-tutorial').addEventListener('click', (e) => {
            e.preventDefault();
            tutorialModal.classList.add('visible');
        });
        document.getElementById('btn-close-tutorial').addEventListener('click', () => {
            tutorialModal.classList.remove('visible');
            localStorage.setItem('kegel_tutorial_seen', 'true');
        });

        // å®Œæˆå¼¹çª—
        document.getElementById('btn-close-complete').addEventListener('click', () => {
            document.getElementById('complete-modal').classList.remove('visible');
            setProgress(0);
        });

        // ==================== åˆå§‹åŒ– ====================
        initStats();

        // é¦–æ¬¡è®¿é—®æ˜¾ç¤ºæ•™ç¨‹
        if (!localStorage.getItem('kegel_tutorial_seen')) {
            setTimeout(() => tutorialModal.classList.add('visible'), 800);
        }
    </script>
</body>
</html>
